(function(w,F){function n(b,d){throw Error('declare("'+d+'"): '+b);}function x(b,d){for(var a=[],c=0,g={},e={pos:0,map:{},refs:[]},f=0,h=b.length;f<h;++f){var k=b[f],l=k.metadef,m=l?l.bases.slice(0):[],l=k.prototype.typedef,p={pos:0,map:{},refs:m};e.refs.push(k);e.map[l]=!0;for(var k=0,n=m.length;k<n;++k)l=m[k].prototype.typedef,p.map[l]=!0,g[l]||(c++,g[l]=!0);a.push(p)}1<h&&a.push(e);g=[];for(f=0;c&&f!==a.length;){p=a[f];e=p.refs[0];l=e.prototype.typedef;for(k=0;k<a.length;++k)if(f!==k&&(h=a[k],
l in h.map&&h.refs[0].prototype.typedef!==l)){e=!1;break}if(e)for(f=0,c--,g.push(e),k=0;k<a.length;++k)h=a[k],delete h.map[l],0<h.refs.length&&h.refs[0].prototype.typedef===l&&h.refs.shift(),0===h.refs.length&&(k<f&&f--,a.splice(k--,1));else f++}if(c)throw Error("can not build a consistent and linear method resolution order");return g}function y(){var b=arguments,d,a,c,g,e,f,h,k;1<b.length?(g=b[0],args=b[1]):args=b[0];d=args.callee;(g=g||d.nom)||n("can not deduce a name to call inherited()",this.typedef);
a=this.constructor.metadef;b=a.bases;k=this.__super__=this.__super__||{};c=k.p;if("constructor"!==g){if(k.c!==d&&(c=0,e=b[0],a=e.metadef,a.proto[g]!==d)){for(;(e=b[++c])&&!(a=e.metadef,f=e.prototype,a&&a.proto[g]===d||f[g]===d&&f.hasOwnProperty(g)););c=e?c:-1}for(d=m[g];e=b[++c];)if(f=e.prototype,f[g]&&(e.metadef?f.hasOwnProperty(g):d!==f[g])){h=f[g];break}h=e&&h||d}else{if(k.c!==d&&(c=0,e=b[0],a=e.metadef,a.ctor!==d)){for(;(e=b[++c])&&(!(a=e.meta)||a.ctor!==d););c=e?c:-1}for(;(e=b[++c])&&!(h=(a=
e.metadef)?a.ctor:e););h=e&&h}k.p=c;if(k.c=h)return h.apply(this,args)}function z(b){for(var d=this.constructor.metadef.bases,a=0,c=d.length;a<c;++a)if(d[a]===b)return!0;return this instanceof b}function A(b){r(this.prototype,b);return this}function B(b,d,a){for(var c in d){var g=d[c];c in b&&(b[c]===g||c in t&&t[c]===g)||(b[c]=a?a(c,g):g)}return b}function C(b,d){for(var a in d)"constructor"!==a&&d.hasOwnProperty(a)&&(b[a]=d[a])}function r(b,d){var a,c;for(a in d)c=d[a],c===m[a]&&a in m||"constructor"===
a||("[object Function]"===toString.call(c)&&(c.nom=a),b[a]=c);return b}function D(b){return function(){if(!(this instanceof arguments.callee))return u(arguments);for(var d=b.length-1;0<=d;--d){var a=b[d],c=a.metadef;(a=c?c.ctor:a)&&a.apply(this,arguments)}}}function E(b){return function(){if(!(this instanceof arguments.callee))return u(arguments);b&&b.apply(this,arguments)}}function v(b){q.prototype=b.prototype;b=new q;q.prototype=null;return b}function u(b){var d=b.callee,a=v(d);d.apply(a,b);return a}
var q=new Function,m=Object.prototype,t={};w.declare=function(b,d,a){var c=[0],g=d,e,f,h;"[object Array]"===toString.call(d)?c=c.concat(x(d,b)):d?"[object Function]"===toString.call(d)?(f=d.metadef,c=c.concat(f?f.bases:d)):n("super class is not a callable constructor.",b):null!==d&&n("unknown super class.",b);if(d=c[c.length-1])for(h=c.length-2;;--h){f=v(d);if(!h)break;e=c[h];(e.metadef?C:B)(f,e.prototype);e=new Function;e.superclass=d;e.prototype=f;d=f.constructor=e}else f={};r(f,a);e=a.constructor;
e!==m.constructor&&(e.nom="constructor",f.constructor=e);c[0]=e=1===c.length?E(a.constructor):D(c);e.metadef={bases:c,parents:g,ctor:a.constructor,proto:a};e.extend=A;e.prototype=f;f.constructor=e;f.inherited=y;f.isInstanceOf=z;b&&(f.typedef=b);return e}})(this,void 0);